//Timer1 used maintain a steady refresh rate of the lamps.
#include <TimerOne.h>
#include <Wire.h>

//display register control pins
#define PWM 5

int t; //unit time ~33.3ms
float freq; // cycles

//////////////////////////////////////////////////////////////////////////////

void setup() {
  
  t = 0;
  freq = .01;

  pinMode(PWM, OUTPUT);
  
  Timer1.initialize(1e6 / 30); // period in micro seconds (1x10^6 / frames per second)
  Timer1.attachInterrupt(callback);
  
}

//////////////////////////////////////////////////////////////////////////////

void loop() {
}

//////////////////////////////////////////////////////////////////////////////

void callback() {
  setBrightness(cycle());
}

//////////////////////////////////////////////////////////////////////////////

byte cycle(){
  t++;
  return byte(float(255) * (0.5 * sin(2*PI*freq*float(t)) + .5 ) ); 
}


//////////////////////////////////////////////////////////////////////////////

void setBrightness(byte brightness){
  analogWrite(PWM, brightness);
}

//////////////////////////////////////////////////////////////////////////////
